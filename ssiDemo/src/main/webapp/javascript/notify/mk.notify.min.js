(function(c,e){
	c.mk_notify=function(f){
		return new b(f);
	};
	var b=function(f){
		if(typeof f=="string"){
			f={
				body:f
			};
		}
		var g=c.extend({},b.defaults,f);
		this.element=null;
		this.timer=null;
		this.init=function(){
			d(this,g);
			var h=this;
			if(g.auto_remove){
				this.timer=setTimeout(function(){
					h.remove();
				}
				,g.delay);
				this.element.bind("mouseenter",function(i){
					if(!!h.timer){
						clearTimeout(h.timer);
					}
				}).bind("mouseleave",function(i){
					if(g.auto_remove){
						h.timer=setTimeout(function(){
							h.remove();
						}
						,g.delay);
					}
				});
			}
		};
		this.remove=function(){
			if(this.element!==e&&this.element!==null){
				this.element.remove();
			}
			a(g);
		};
		if(!g.is_init){
			this.init();
		}
	};
	function d(l,g){
		var j=g;
		var k=c(window);
		var h=c('<div class="'+j.notify_class+'"></div>').hide().appendTo(c("body"));
		l.element=h;
		h.css({
			width:j.width
		});
		var f=c('<div class="'+j.notify_container_class+'"></div>').appendTo(h);
		if(!!j.type){
			f.addClass(j.notify_alert_class+j.type);
		}
		c('<div class="'+j.notify_icon_class+" "+(j.icon?j.icon:"mk-icon-16-message")+'"></div>').appendTo(f);
		if(j.closable){
			c('<div class="'+j.notify_close_class+" "+j.notify_close_icon_class+'"></div>').appendTo(f);
			h.find("."+j.notify_close_class).bind("click",function(){
				l.remove();
			});
		}
		c('<div class="'+j.notify_title_class+'">'+(j.title?j.title:"&nbsp;")+"</div>").appendTo(f);
		c('<div class="'+j.notify_body_class+'">'+(j.body?j.body:"")+"</div>").appendTo(f);
		h.css({
			top:k.height()-h.height()-2,left:k.width()-h.width()-2
		}).show();
		var i=c("."+j.notify_class);
		if(i.length>j.count){
			i.eq(0).remove();
		}
		a(j);
		c(window).bind("resize",function(){
			a(j);
		});
	}
	function a(k){
		var j=c("."+k.notify_class);
		var l=c(window);
		var f=0;
		for(var h=j.length-1;h>=0;h--){
			var g=j.eq(h);
			f+=g.height()+k.top_offset;
			g.css({
				top:l.height()-f,left:l.width()-g.width()-k.left_offset
			});
		}
	}
	b.defaults={
		title:false,title_escape:false,body:false,body_escape:false,width:300,min_height:16,icon:false,closable:true,auto_remove:true,delay:5000,type:false,notify_class:"mk-notify",notify_container_class:"mk-notify-container mk-notify-shadow",notify_title_class:"mk-notify-title",notify_icon_class:"mk-notify-icon",notify_close_class:"mk-notify-close",notify_close_icon_class:"mk-icon-16-close",notify_body_class:"mk-notify-body",notify_alert_class:"alert-",count:5,top_offset:2,left_offset:2
	};
})(jQuery);